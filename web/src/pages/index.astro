---
/**
 * Homepage - pre-rendered at build time (default behavior)
 */
import { getEntry, getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import FeatureCard from '../components/FeatureCard.astro';
import WorldCard from '../components/WorldCard.astro';
import ServerStatus from '../components/ServerStatus.astro';
import Button from '../components/Button.astro';

// Get server info and features
const serverInfo = await getEntry('server-info', 'blockhaven');

// Get survival worlds for preview
const allWorlds = await getCollection('worlds');
const survivalWorlds = allWorlds
  .filter((w) => w.data.type === 'survival')
  .sort((a, b) => (a.data.order || 0) - (b.data.order || 0));
---

<BaseLayout title="Family-Friendly Cross-Platform Minecraft Server" description="Welcome to BlockHaven - A family-friendly, cross-platform Minecraft server">
  <!-- Hero Section -->
  <section class="relative py-20 px-4 sm:px-6 lg:px-8 overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-b from-primary-gold/5 to-transparent"></div>
    <div class="max-w-6xl mx-auto relative">
      <div class="text-center">
        <h1 class="text-5xl sm:text-6xl lg:text-7xl font-bold text-primary-gold mb-6">
          BlockHaven
        </h1>
        <p class="text-xl sm:text-2xl text-text-muted mb-8 max-w-2xl mx-auto">
          {serverInfo?.data.tagline}
        </p>

        <!-- Server Status Widget with Background -->
        <div class="relative flex items-center justify-center mb-8">
          <img
            src="/blockhaven-icon-medium.png"
            alt=""
            class="w-[500px] sm:w-[600px] lg:w-[700px] h-auto pointer-events-none"
          />
          <div class="absolute inset-0 flex items-center justify-center">
            <div class="w-full max-w-sm bg-primary-wheat/15 backdrop-blur-sm rounded-xl p-4">
              <ServerStatus />
            </div>
          </div>
        </div>

        <!-- CTA Button -->
        <div class="flex items-center justify-center">
          <Button href="/connect" variant="secondary" size="lg">
            How to Connect
          </Button>
        </div>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="py-16 px-4 sm:px-6 lg:px-8 bg-secondary-stone/5">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-text-light mb-4">
          Why BlockHaven?
        </h2>
        <p class="text-text-muted max-w-2xl mx-auto">
          A great Minecraft experience on any platform
        </p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {serverInfo?.data.features.map((feature) => (
          <FeatureCard
            title={feature.title}
            description={feature.description}
            icon={feature.icon}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Worlds Preview Section -->
  <section class="py-16 px-4 sm:px-6 lg:px-8">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-text-light mb-4">
          Choose Your Adventure
        </h2>
        <p class="text-text-muted max-w-2xl mx-auto">
          Multiple survival worlds with different difficulties - find your perfect challenge
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        {survivalWorlds.map((world) => (
          <WorldCard
            id={world.data.id}
            displayName={world.data.displayName}
            alias={world.data.alias}
            type={world.data.type}
            difficulty={world.data.difficulty}
            description={world.data.description}
            features={world.data.features}
            hasNether={world.data.hasNether}
            hasEnd={world.data.hasEnd}
            compact
          />
        ))}
      </div>

      <div class="text-center">
        <Button href="/worlds" variant="secondary">
          View All Worlds ‚Üí
        </Button>
      </div>
    </div>
  </section>

  <!-- Rules Preview Section -->
  <section class="py-16 px-4 sm:px-6 lg:px-8 bg-secondary-stone/5">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl sm:text-4xl font-bold text-text-light mb-4">
        Family-Friendly Environment
      </h2>
      <p class="text-text-muted mb-8 max-w-2xl mx-auto">
        BlockHaven is a safe space for players of all ages. We maintain clear rules
        and active moderation to ensure everyone has a great experience.
      </p>

      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
        <div class="p-4 rounded-lg bg-secondary-stone/10">
          <span class="text-2xl">üõ°Ô∏è</span>
          <p class="text-text-light font-medium mt-2">No Griefing</p>
        </div>
        <div class="p-4 rounded-lg bg-secondary-stone/10">
          <span class="text-2xl">üí¨</span>
          <p class="text-text-light font-medium mt-2">Clean Chat</p>
        </div>
        <div class="p-4 rounded-lg bg-secondary-stone/10">
          <span class="text-2xl">üë•</span>
          <p class="text-text-light font-medium mt-2">Respectful Community</p>
        </div>
      </div>

      <Button href="/rules" variant="secondary">
        Read Full Rules ‚Üí
      </Button>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-20 px-4 sm:px-6 lg:px-8">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl sm:text-4xl font-bold text-text-light mb-4">
        Ready to Join?
      </h2>
      <p class="text-text-muted mb-8 max-w-2xl mx-auto">
        BlockHaven just launched and we're accepting new players! Get in from the start,
        explore new frontiers, and become a founding settler.
      </p>
      <Button href="/guide#quick-start" size="lg">
        Getting Started
      </Button>
      <p class="text-sm text-text-muted mt-4">
        Console players refer to workarounds on <a href="/connect" class="text-primary-gold hover:text-primary-wheat underline transition-colors">how to Connect</a>
      </p>
    </div>
  </section>
</BaseLayout>
